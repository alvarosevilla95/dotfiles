# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
#set -g @plugin 'sainnhe/tmux-fzf'
run -b '~/.tmux/plugins/tpm/tpm'

set-option -g history-limit 100000
set -g default-terminal "screen-256color"
set -g prefix C-Space

set-option -g allow-rename off

unbind ^Space
bind ^Space select-pane -t :.+
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind H select-pane -L \; swap-pane -s '!'
bind J select-pane -D \; swap-pane -s '!'
bind K select-pane -U \; swap-pane -s '!'
bind L select-pane -R \; swap-pane -s '!'
bind '%' split-window -h -c '#{pane_current_path}'  
bind '"' split-window -v -c '#{pane_current_path}'
bind c new-window -c '#{pane_current_path}' 
bind C break-pane -t :
bind-key r source-file ~/.tmux.conf \; display "Config reloaded!"

setw -g mode-keys vi
bind-key -T copy-mode-vi 'v' send-keys -X begin-selection
#bind-key -T copy-mode-vi 'y' send-keys -X copy-selection
bind-key -T copy-mode-vi 'y' send-keys -X copy-pipe "pbcopy"
set -g mouse on

bind-key s run -b /Users/alvaro/dotfiles/scripts/ftsession
bind-key f run -b /Users/alvaro/dotfiles/scripts/ftwind
bind-key F run -b /Users/alvaro/dotfiles/scripts/ftpane

# Status bar tiles
set-window-option -g status-left "#S"
set-window-option -g status-right " %H:%M "
set-window-option -g window-status-format " #I: #W "
set-window-option -g window-status-current-format " #I: #W "


# Gruvbox Colorsceme
set-option -g status "on"
set-option -g status-style bg=colour237,fg=colour223 # bg=bg1, fg=fg1
set-window-option -g window-status-style bg=colour214,fg=colour237 # bg=yellow, fg=bg1
set-window-option -g window-status-activity-style bg=colour237,fg=colour248 # bg=bg1, fg=fg3
set-window-option -g window-status-current-style bg=red,fg=colour237 # fg=bg1
set-option -g pane-active-border-style fg=colour250 #fg2
set-option -g pane-border-style fg=colour237 #bg1
set-option -g message-style bg=colour239,fg=colour223 # bg=bg2, fg=fg1
set-option -g message-command-style bg=colour239,fg=colour223 # bg=fg3, fg=bg1
set-option -g display-panes-active-colour colour250 #fg2
set-option -g display-panes-colour colour237 #bg1
set-window-option -g clock-mode-colour colour109 #blue
set-window-option -g window-status-bell-style bg=colour167,fg=colour235 # bg=red, fg=bg
set-option -g status-justify "left"
set-option -g status-left-style none
set-option -g status-left-length "80"
set-option -g status-right-style none
set-option -g status-right-length "80"
set-window-option -g window-status-separator ""
set-option -g status-left "#[fg=colour239, bg=colour248] #S #[fg=colour241, bg=colour237, nobold, noitalics, nounderscore]"
set-option -g status-right "#[fg=colour239, bg=colour237, nobold, nounderscore, noitalics]#[fg=colour246,bg=colour239] %Y-%m-%d %H:%M #[fg=colour248, bg=colour239, nobold, noitalics, nounderscore]#[fg=colour237, bg=colour248] #h "
set-window-option -g window-status-current-format "#[fg=colour237, bg=colour214, nobold, noitalics, nounderscore]#[fg=colour248, bg=colour241] #I#[fg=colour248, bg=colour241, bold] #W #[fg=colour214, bg=colour237, nobold, noitalics, nounderscore]"
set-window-option -g window-status-format "#[fg=colour237,bg=colour239,noitalics]#[fg=colour223,bg=colour239] #I #[fg=colour223, bg=colour239] #W #[fg=colour239, bg=colour237, noitalics]"

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"

bind l if-shell "$is_vim" 'send-keys C-l'  'select-pane -R'
bind h if-shell "$is_vim" 'send-keys C-h'  'select-pane -L'
bind j if-shell "$is_vim" 'send-keys C-j'  'select-pane -D'
bind k if-shell "$is_vim" 'send-keys C-k'  'select-pane -U'
tmux_version='$(tmux -V | sed -En "s/^tmux ([0-9]+(.[0-9]+)?).*/\1/p")'
if-shell -b '[ "$(echo "$tmux_version < 3.0" | bc)" = 1 ]' \
    "bind-key -n 'C-\\' if-shell \"$is_vim\" 'send-keys C-\\'  'select-pane -l'"

# bind -T copy-mode-vi h select-pane -L
# bind -T copy-mode-vi j select-pane -D
# bind -T copy-mode-vi k select-pane -U
# bind -T copy-mode-vi l select-pane -R
set -ga terminal-overrides ",xterm-256color:Tc"
